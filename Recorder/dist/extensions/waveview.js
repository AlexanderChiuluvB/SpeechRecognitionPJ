/*
录音
https://github.com/xiangyuecn/Recorder
src: extensions/waveview.js
*/
!function(){var e=function(e){return new t(e)},t=function(e){var t=this,i={scale:2,speed:8,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var a in e)i[a]=e[a];t.set=e=i;var r=e.elem;r&&("string"==typeof r?r=document.querySelector(r):r.length&&(r=r[0])),r&&(e.width=r.offsetWidth,e.height=r.offsetHeight);var n=e.scale,h=e.width*n,l=e.height*n,o=t.elem=document.createElement("div");o.innerHTML='<div style="width:'+e.width+"px;height:"+e.height+'px;overflow:hidden"><div style="width:'+h+"px;height:"+l+"px;transform-origin:0 0;transform:scale("+1/n+')"><canvas/></div></div>';var g=t.canvas=o.querySelector("canvas"),s=t.ctx=g.getContext("2d");g.width=h,g.height=l,t.linear1=t.genLinear(s,h,e.linear1),t.linear2=t.genLinear(s,h,e.linear2),t.linearBg=t.genLinear(s,l,e.linearBg,!0),r&&(r.innerHTML="",r.appendChild(o)),t._phase=0};t.prototype=e.prototype={genLinear:function(e,t,i,a){for(var r=e.createLinearGradient(0,0,a?0:t,a?t:0),n=0;n<i.length;)r.addColorStop(i[n++],i[n++]);return r},genPath:function(e,t,i){for(var a=[],r=this.set,n=r.scale,h=r.width*n,l=r.height*n/2,o=0;o<h;o+=n){var g=(1+Math.cos(Math.PI+o/h*2*Math.PI))/2*l*t*Math.sin(2*Math.PI*(o/h)*e+i)+l;a.push(g)}return a},input:function(e,t,i){var a=this,r=a.set,n=a.ctx,h=r.scale,l=r.width*h,o=r.height*h,g=r.speed*e.length/i,s=a._phase-=g,d=t/100,c=a.genPath(2,d,s),v=a.genPath(1.8,d,s+5*g);n.clearRect(0,0,l,o),n.beginPath();for(var f=0,p=0;p<l;f++,p+=h)0==p?n.moveTo(p,c[f]):n.lineTo(p,c[f]);f--;for(p=l-1;0<=p;f--,p-=h)n.lineTo(p,v[f]);n.closePath(),n.fillStyle=a.linearBg,n.fill(),a.drawPath(v,a.linear2),a.drawPath(c,a.linear1)},drawPath:function(e,t){var i=this.set,a=this.ctx,r=i.scale,n=i.width*r;a.beginPath();for(var h=0,l=0;l<n;h++,l+=r)0==l?a.moveTo(l,e[h]):a.lineTo(l,e[h]);a.lineWidth=i.lineWidth*r,a.strokeStyle=t,a.stroke()}},Recorder.WaveView=e}();